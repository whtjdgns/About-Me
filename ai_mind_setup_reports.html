<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 마음 상담소 (AI Mind Care Center) 기술 보고서</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #1e40af;
            --text-color: #334155;
            --bg-color: #f8fafc;
            --card-bg: #ffffff;
            --border-color: #e2e8f0;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, 'Helvetica Neue', 'Segoe UI', 'Apple SD Gothic Neo', 'Malgun Gothic', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--bg-color);
            margin: 0;
            padding: 40px 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: var(--card-bg);
            padding: 50px;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        h1 {
            color: var(--secondary-color);
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 15px;
            margin-bottom: 40px;
            font-size: 2.2rem;
            text-align: center;
        }

        h2 {
            color: var(--secondary-color);
            border-left: 5px solid var(--primary-color);
            padding-left: 15px;
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        h3 {
            color: #475569;
            margin-top: 25px;
            font-size: 1.2rem;
            font-weight: 600;
        }

        p {
            margin-bottom: 1rem;
        }

        /* Custom List Style for 1) 2) 3) */
        ol.custom-list {
            list-style-type: none;
            counter-reset: my-counter;
            padding-left: 0;
            margin-bottom: 20px;
        }

        ol.custom-list li {
            counter-increment: my-counter;
            margin-bottom: 8px;
            padding-left: 30px; /* Space for the number */
            position: relative;
        }

        ol.custom-list li::before {
            content: counter(my-counter) ") ";
            position: absolute;
            left: 0;
            color: var(--primary-color);
            font-weight: bold;
        }
        
        /* Keep standard padding for other lists if needed */
        ul, ol:not(.custom-list) {
            padding-left: 20px;
            margin-bottom: 20px;
        }

        li {
            margin-bottom: 8px;
        }

        /* Table Styling */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--border-color);
            padding: 12px 15px;
            text-align: left;
        }

        th {
            background-color: #eff6ff;
            color: var(--secondary-color);
            font-weight: 600;
            width: 25%;
        }

        /* Box Styling for emphasis */
        .info-box {
            background-color: #f1f5f9;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid var(--border-color);
        }

        .highlight {
            color: var(--primary-color);
            font-weight: 600;
        }

        /* Troubleshooting Section */
        .troubleshooting {
            background-color: #fff1f2;
            border-left: 4px solid #e11d48;
            padding: 15px;
            margin: 15px 0;
        }
        
        .troubleshooting h3 {
            color: #be123c;
            margin-top: 0;
        }

        /* Architecture Steps */
        .step {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .step-num {
            background-color: var(--primary-color);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            margin-right: 10px;
            flex-shrink: 0;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            th, td {
                display: block;
                width: 100%;
            }
            th {
                background-color: #e0f2fe;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>[Project] AI 마음 상담소 기술 보고서</h1>

        <h2>1. 프로젝트 개요 (Overview)</h2>
        <div class="info-box">
            <ol class="custom-list">
                <p><strong>프로젝트명:</strong> AI 마음 상담소 (AI Mind Care Center)</p>
                <p><strong>한 줄 소개:</strong> 사용자가 직접 설정한 페르소나(Persona)와 시각적 배경을 통해 깊이 있는 공감과 위로를 제공하는 웹 기반 심리 상담 서비스</p>
                <p><strong>개발 유형:</strong> 개인 프로젝트 (Full Stack)</p>
                <p><strong>핵심 가치:</strong> 익명성 보장, 완전한 개인화, 시각적 몰입감을 통한 심리적 안정 제공</p>
            </ol>
        </div>

        <h2>2. 기획 의도 및 해결 과제</h2>
        <h3>2.1. 개발 배경</h3>
        <p>살다 보면 가족이나 친구에게조차 털어놓기 힘든 고민이 생길 때가 있습니다. 흥미롭게도 많은 사람들이 이런 깊은 이야기를 AI에게는 부담 없이 이야기하곤 합니다. 이는 AI가 가진 <strong>'비판하지 않는 태도(Non-judgmental Attitude)'</strong>와 <strong>'철저한 익명성'</strong>이 사람들에게 심리적 안전지대를 제공하기 때문이라고 생각했습니다.</p>
        <p>저는 이 점에 착안하여, 단순히 텍스트만 주고받는 건조한 챗봇이 아니라 <span class="highlight">마치 나만의 안전한 공간에 있는 듯한 느낌</span>을 주고 싶었습니다. 이를 위해 사용자가 편안함을 느끼는 대화 상대를 직접 설정하고, 그에 어울리는 시각적 배경(Visual UI)까지 제공하여 진정한 위로를 건네는 서비스를 기획하게 되었습니다.</p>

        <h3>2.2. 기술적 목표</h3>
        <ol class="custom-list">
            <p><strong>개인화된 상담 경험:</strong> 사용자가 정의한 AI의 말투와 성격이 대화 끝까지 일관성 있게 유지되도록 구현.</p>
            <p><strong>시각적 몰입감 (Multimodal):</strong> 텍스트 대화에 맞춰 생성형 AI(DALL-E 3)가 실시간으로 따뜻하고 감성적인 배경을 생성.</p>
            <p><strong>안전한 서비스:</strong> 민감할 수 있는 상담 내용을 보호하기 위해 OAuth 2.0 기반의 안전한 인증 체계 구축.</p>
        </ol>

        <h2>3. 기술 스택 (Tech Stack)</h2>
        <table>
            <thead>
                <tr>
                    <th>영역</th>
                    <th>사용 기술</th>
                    <th>선정 이유</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Frontend</strong></td>
                    <td>React, Tailwind CSS</td>
                    <td>사용자 경험(UX)을 중시한 유연한 UI 구성과 빠른 스타일링 적용을 위해 채택했습니다.</td>
                </tr>
                <tr>
                    <td><strong>Backend</strong></td>
                    <td>Node.js, Express</td>
                    <td>비동기 처리에 강점이 있어, AI API 응답 대기 시간 동안에도 서버 리소스를 효율적으로 관리하기 적합했습니다.</td>
                </tr>
                <tr>
                    <td><strong>Database</strong></td>
                    <td>MySQL</td>
                    <td>사용자, 세션, 메시지 간의 관계가 명확하므로 관계형 데이터베이스가 데이터 무결성 유지에 유리하다고 판단했습니다.</td>
                </tr>
                <tr>
                    <td><strong>AI Model</strong></td>
                    <td>GPT-4o, DALL-E 3</td>
                    <td>복잡한 맥락을 이해하는 언어 능력과 고품질 이미지 생성 능력을 모두 갖춘 OpenAI API를 활용했습니다.</td>
                </tr>
                <tr>
                    <td><strong>Auth</strong></td>
                    <td>Passport.js</td>
                    <td>Google OAuth 전략을 사용하여 보안성을 높이면서도 사용자가 간편하게 접근할 수 있도록 구현했습니다.</td>
                </tr>
            </tbody>
        </table>

        <h2>4. 시스템 아키텍처 및 흐름</h2>
        <p>개발 효율성을 위해 클라이언트와 서버를 분리하여 개발했으나, 최종 배포 시에는 관리의 편의성을 고려하여 Express 서버가 React 정적 파일을 함께 서빙하는 <strong>모놀리식(Monolithic) 구조</strong>로 통합하였습니다.</p>
        
        <h3>4.1. 데이터 흐름도 (Logic Flow)</h3>
        <div class="step"><span class="step-num">1</span> Client: 사용자 입력 -> API 요청 (/api/chat)</div>
        <div class="step"><span class="step-num">2</span> Server: 요청 수신 -> DB에서 세션 설정(페르소나) 및 이전 대화 기록 조회</div>
        <div class="step"><span class="step-num">3</span> Prompt Engine: 조회된 데이터를 바탕으로 동적 시스템 프롬프트 생성</div>
        <div class="step"><span class="step-num">4</span> AI Engine: OpenAI API 호출 (GPT-4o / DALL-E 3) -> 응답 수신</div>
        <div class="step"><span class="step-num">5</span> DB: 사용자 질문 및 AI 응답 저장 -> Client로 응답 반환</div>

        <h2>5. 핵심 기능 구현 과정</h2>
        
        <h3>5.1. 사용자 맞춤형 AI (Dynamic Persona Injection)</h3>
        <ol class="custom-list">
            <p><strong>구현:</strong> 모든 사용자가 똑같은 AI와 대화하는 것은 식상하다고 느꼈습니다. 그래서 <code>backend/routes/chat.js</code>에서 매 요청마다 DB에 저장된 <code>role_description</code>(예: 다정한 친구, 냉철한 조언자)을 불러와 시스템 프롬프트에 주입했습니다.</p>
            <p><strong>효과:</strong> 별도의 복잡한 학습(Fine-tuning) 과정 없이도, 프롬프트 엔지니어링만으로 사용자가 원하는 맞춤형 상담사를 완벽하게 구현할 수 있었습니다.</p>
        </ol>

        <h3>5.2. 상황에 맞는 배경 생성 (Visual Immersion)</h3>
        <ol class="custom-list">
            <p><strong>구현:</strong> 텍스트만으로는 전달하기 힘든 분위기를 연출하기 위해 DALL-E 3를 연동했습니다. 사용자가 입력한 '장소 묘사'가 변경될 때만 이미지를 생성하도록 하여 비용 효율성도 고려했습니다.</p>
            <p><strong>최적화:</strong> 생성된 이미지는 별도의 스토리지 서버를 구축하는 대신, Base64 문자열로 변환하여 DB에 저장함으로써 인프라 복잡도를 낮췄습니다.</p>
        </ol>

        <h2>6. 데이터베이스 설계</h2>
        <ol class="custom-list">
            <p><strong>Users:</strong> 사용자 기본 정보 관리 (Google ID 연동).</p>
            <p><strong>ChatSessions:</strong> 하나의 계정으로 여러 상담방을 만들 수 있도록 1:N 관계로 설계하여, 사용자가 상황별로 다른 상담사(방)를 둘 수 있게 했습니다.</p>
            <p><strong>ChatMessages:</strong> 대화의 흐름을 끊기지 않고 이어가기 위해 메시지별 타임스탬프와 순서를 기록합니다.</p>
        </ol>

        <h2>7. 트러블 슈팅 (Troubleshooting)</h2>
        <div class="troubleshooting">
            <h3>Issue: 대화가 길어질수록 AI가 설정을 잊는 현상</h3>
            <p><strong>문제 상황:</strong> 초기 테스트 중, 대화가 10턴 이상 넘어가면 AI가 초반에 설정한 말투나 역할을 잊어버리고 기본 AI 말투로 돌아가는 문제가 발생했습니다.</p>
            <p><strong>원인 분석:</strong> LLM이 한 번에 처리할 수 있는 토큰(Context Window)의 한계 때문에, 대화 내용이 쌓일수록 초반의 시스템 프롬프트가 밀려나는 것이 원인이었습니다.</p>
            <p><strong>해결 과정:</strong></p>
            <ol class="custom-list">
                <P>무조건 모든 대화 내역을 보내는 대신, <strong>최근 대화 10쌍</strong>만 추려서 전송하도록 로직을 변경했습니다.</P>
                <p>대신 AI의 정체성을 담은 <strong>시스템 프롬프트</strong>는 대화 길이에 상관없이 항상 최상단에 고정하여 전송되도록 수정했습니다.</p>
            </ol>
            <p><strong>결과:</strong> 이를 통해 토큰 비용은 절감하면서도, 상담이 끝날 때까지 AI가 일관된 태도를 유지하도록 개선할 수 있었습니다.</p>
        </div>

        <h2>8. 프로젝트를 마치며 (Conclusion)</h2>
        <p>이번 프로젝트를 통해 단순히 API를 연결하는 것을 넘어, <strong>'사용자의 심리적 경험'을 기술로 어떻게 풀어낼 것인가</strong>에 대해 깊이 고민할 수 있었습니다. 특히 프롬프트 엔지니어링을 통해 AI에게 인격을 부여하고, 시각적 요소를 결합하여 몰입감을 높이는 과정에서 풀스택 개발자로서의 기술적 역량과 기획력을 함께 성장시킬 수 있었습니다.</p>
        <p>향후에는 <strong>실시간 통신(WebSocket)</strong>을 도입하여 AI가 답변을 작성 중임을 시각적으로 보여주는 기능을 추가하고, <strong>벡터 데이터베이스(Vector DB)</strong>를 활용해 장기 기억 능력을 강화하여 더욱 사람 같은 상담소로 발전시킬 계획입니다.</p>
    </div>
</body>
</html>